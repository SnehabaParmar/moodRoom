<style>
  body.confusion-active {
    background: linear-gradient(120deg, #c0d6e4, #e8f0c0, #f7e0c0);
    background-size: 200% 200%;
    animation: confusionMove 8s ease-in-out infinite;
  }

  @keyframes confusionMove {
    0% {
      background-position: 0% 50%;
    }

    50% {
      background-position: 100% 50%;
    }

    100% {
      background-position: 0% 50%;
    }
  }

  .confuse-mark {
    position: absolute;
    font-size: 24px;
    animation: floatConfuse 3s ease-in-out forwards;
    pointer-events: none;
  }

  @keyframes floatConfuse {
    0% {
      transform: translateY(0) rotate(0deg);
      opacity: 0;
    }

    20% {
      opacity: 1;
    }

    50% {
      transform: translateY(-30vh) rotate(20deg);
    }

    100% {
      transform: translateY(-60vh) rotate(-20deg);
      opacity: 0;
    }
  }

  .confuse-glow {
    position: absolute;
    border-radius: 50%;
    filter: blur(25px);
    background: radial-gradient(circle, rgba(200, 200, 255, 0.5), rgba(200, 200, 255, 0));
    opacity: 0.5;
    animation: glowPulse 4s ease-in-out infinite;
    pointer-events: none;
  }

  @keyframes glowPulse {
    0% {
      transform: scale(1);
      opacity: 0.5;
    }

    50% {
      transform: scale(1.3);
      opacity: 0.7;
    }

    100% {
      transform: scale(1);
      opacity: 0.5;
    }
  }
</style>

<div id="theme-animation-container"></div>

<script>
  const container = document.getElementById("theme-animation-container");

  function startTheme() {
    document.body.classList.add('confusion-active');
    window.__confusionIntervals = window.__confusionIntervals || [];

    function createMark() {
      const el = document.createElement('div');
      el.className = 'confuse-mark';
      el.textContent = "â“";
      el.style.left = Math.random() * 100 + 'vw';
      el.style.top = Math.random() * 100 + 'vh';
      el.style.fontSize = (16 + Math.random() * 24) + 'px';
      el.style.animationDuration = (2 + Math.random() * 2) + 's';
      container.appendChild(el);
      setTimeout(() => el.remove(), 4000);
    }

    function createGlow() {
      const el = document.createElement('div');
      el.className = 'confuse-glow';
      const size = Math.random() * 100 + 50;
      el.style.width = size + 'px';
      el.style.height = size + 'px';
      el.style.left = Math.random() * 100 + 'vw';
      el.style.top = Math.random() * 100 + 'vh';
      container.appendChild(el);
      setTimeout(() => el.remove(), 5000);
    }

    window.__confusionIntervals.push(setInterval(createMark, 300));
    window.__confusionIntervals.push(setInterval(createGlow, 1200));
  }

  function stopTheme() {
    if (window.__confusionIntervals) {
      window.__confusionIntervals.forEach(i => clearInterval(i));
      window.__confusionIntervals = [];
    }
    container.innerHTML = "";
    document.body.classList.remove('confusion-active');
  }
</script>