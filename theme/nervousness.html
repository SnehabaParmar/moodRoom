<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nervousness Theme â€” Sparks + Blurry Fog</title>
  <style>
    :root {
      --bg-fallback-1: #e9f6fb;
      --bg-fallback-2: #f3f7fb;
      --accent: #7fe6ff;
      --spark1: #9ef0ff;
      --spark2: #ffd28a;
      --spark3: #ff9fb3;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      height: 100%;
      width: 100%;
    }

    body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background:
        linear-gradient(180deg, var(--bg-fallback-1), var(--bg-fallback-2));
      background-image:
        linear-gradient(rgba(18, 24, 38, 0.18), rgba(18, 24, 38, 0.25)),
        url('https://t4.ftcdn.net/jpg/06/27/23/87/360_F_627238754_9u7TPXuCtEGXMb40FMkxSHDSEWsnV7LE.jpg');
      background-size: cover;
      background-position: center;
      position: relative;
      color: #fff;
    }

    .vignette {
      position: absolute;
      inset: 0;
      pointer-events: none;
      background: radial-gradient(60% 50% at 50% 45%, rgba(255, 255, 255, 0.03) 0%, rgba(0, 0, 0, 0.297) 70%);
      mix-blend-mode: multiply;
    }

    .scene {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      transform-origin: center;
      animation: microBreath 10s ease-in-out infinite;
    }

    @keyframes microBreath {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.006);
      }

      100% {
        transform: scale(1);
      }
    }

    .fog {
      position: absolute;
      inset: -10% -10% -10% -10%;
      pointer-events: none;
      overflow: hidden;
      z-index: 2;
    }

    .fog .layer {
      position: absolute;
      width: 140%;
      height: 110%;
      left: -20%;
      top: 5%;
      filter: blur(36px) contrast(1.05);
      opacity: 0.22;
      background: radial-gradient(circle at 30% 40%, rgba(200, 230, 255, 0.65), rgba(120, 150, 190, 0.06) 40%, transparent 70%);
      animation: fogDrift 18s linear infinite;
    }

    .fog .layer.alt {
      left: -40%;
      top: -10%;
      filter: blur(60px) saturate(1.05);
      opacity: 0.16;
      background: radial-gradient(circle at 70% 60%, rgba(210, 200, 255, 0.45), rgba(140, 130, 170, 0.03) 40%, transparent 75%);
      animation-duration: 26s;
      animation-direction: reverse;
    }

    @keyframes fogDrift {
      0% {
        transform: translateX(0) translateY(0) scale(1);
      }

      50% {
        transform: translateX(8vw) translateY(-3vh) scale(1.02);
      }

      100% {
        transform: translateX(0) translateY(0) scale(1);
      }
    }

    .shake {
      animation: nervousJitter 360ms ease-in-out 1;
    }

    @keyframes nervousJitter {
      0% {
        transform: translateY(0) rotate(0deg);
      }

      20% {
        transform: translateY(-1px) rotate(-0.12deg);
      }

      40% {
        transform: translateY(1px) rotate(0.12deg);
      }

      60% {
        transform: translateY(-1px) rotate(0deg);
      }

      80% {
        transform: translateY(0.6px) rotate(-0.08deg);
      }

      100% {
        transform: translateY(0) rotate(0deg);
      }
    }

    .card {
      position: relative;
      z-index: 6;
      pointer-events: auto;
      width: min(880px, 94vw);
      max-width: 880px;
      padding: 26px 28px;
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.01));
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 6px 40px rgba(10, 15, 30, 0.45);
      display: flex;
      align-items: center;
      gap: 18px;
      backdrop-filter: blur(6px) saturate(1.05);
    }

    .card .left {
      flex: 0 0 140px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card h2 {
      margin: 0;
      font-weight: 600;
      color: #eaf9ff;
      font-size: 20px;
      letter-spacing: 0.2px;
    }

    .card p {
      margin: 6px 0 0 0;
      color: #d7f6ff;
      opacity: 0.9;
      font-size: 14px;
    }

    .spark {
      position: absolute;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 5;
      filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.35));
      will-change: transform, opacity;
      opacity: 0;
      mix-blend-mode: screen;
      bottom: 0;
    }

    .spark.streak {
      width: 3px;
      height: 18px;
      border-radius: 3px;
      transform-origin: center;
      bottom: 0;
    }

    @keyframes sparkFall {
      0% {
        transform: translateY(0) scale(1) rotate(0deg);
        opacity: 1;
      }

      40% {
        opacity: 1;
      }

      100% {
        transform: translateY(40vh) scale(0.85) rotate(20deg);
        opacity: 0;
      }
    }

    @keyframes sparkZig {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 1;
      }

      40% {
        transform: translate(6px, -10vh) rotate(6deg);
        opacity: 0.9;
      }

      100% {
        transform: translate(-10px, -30vh) rotate(20deg);
        opacity: 0;
      }
    }

    .spark::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at 30% 25%, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.1) 40%, transparent 70%);
      opacity: 0.95;
    }

    .grain {
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image: linear-gradient(transparent 50%, rgba(0, 0, 0, 0.02) 50%);
      opacity: 0.04;
      mix-blend-mode: overlay;
    }

    @media (max-width:720px) {
      .card {
        padding: 18px;
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
      }

      .card .left {
        width: 100%;
        justify-content: flex-start;
      }
    }

    .break {
      display: block;
      width: 100%;
      text-align: center;
      color: rgb(53, 55, 57);
      position: absolute;
      bottom: 10%;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="vignette"></div>

  <div class="scene" id="scene">
    <div class="fog" aria-hidden="true">
      <div class="layer"></div>
      <div class="layer alt"></div>
    </div>
    <p class="break">Tap to drop sparkling particles</p>
    <div class="grain"></div>
  </div>

  <script>
    // ----- helpers & config (ADDED so start/stop work) -----
    const scene = document.getElementById('scene');
    const MAX_SPARKS = 80;
    const SPARK_COLORS = ['#9ef0ff', '#ffd28a', '#ff9fb3', '#b6ffe1'];

    const rnd = (min, max) => Math.random() * (max - min) + min;
    const pick = arr => arr[Math.floor(Math.random() * arr.length)];

    // createSpark + micro particle (keeps original behavior)
    function createSpark(x, y) {
      const s = document.createElement('div');
      s.className = 'spark';
      if (Math.random() < 0.45) s.classList.add('streak');

      const color = pick(SPARK_COLORS);
      s.style.background = color;
      s.style.left = `${x}px`;
      s.style.top = `${y}px`;

      const dur = Math.floor(rnd(900, 1600));
      const useZig = Math.random() > 0.5;

      s.style.animation = `${useZig ? 'sparkZig' : 'sparkFall'} ${dur}ms cubic-bezier(.2,.8,.25,1) forwards`;
      s.style.opacity = '1';
      s.style.transform = `translate3d(0,0,0) rotate(${rnd(-10, 10)}deg) scale(${rnd(0.7, 1.3)})`;

      scene.appendChild(s);

      if (Math.random() > 0.6) {
        setTimeout(() => {
          for (let i = 0; i < (Math.random() > 0.7 ? 2 : 1); i++) {
            micro(s, color);
          }
        }, dur * 0.12);
      }

      setTimeout(() => { if (s && s.parentNode) s.parentNode.removeChild(s); }, dur + 120);
    }

    function micro(parent, color) {
      const m = document.createElement('div');
      m.className = 'spark';
      m.style.width = `${rnd(3, 6)}px`;
      m.style.height = `${rnd(3, 10)}px`;
      const left = parseFloat(parent.style.left) + rnd(-12, 12);
      const top = parseFloat(parent.style.top) + rnd(-12, 12);
      m.style.left = `${left}px`;
      m.style.top = `${top}px`;
      m.style.background = color;
      m.style.opacity = '0.95';
      m.style.animation = `sparkZig ${Math.floor(rnd(700, 1400))}ms cubic-bezier(.25,.9,.25,1) forwards`;
      scene.appendChild(m);
      setTimeout(() => { if (m && m.parentNode) m.parentNode.removeChild(m); }, 1200);
    }

    // ----- start/stop wiring -----
    let nervousIntervals = [];           // will hold timeout IDs
    let nervousPointerHandler = null;
    window.__nervousRunning = false;

    function startTheme() {
      if (window.__nervousRunning) return;
      window.__nervousRunning = true;
      scene.style.pointerEvents = 'auto';

      // sparkLoop using timeouts (so we can clear)
      function sparkLoop() {
        if (!window.__nervousRunning) return;
        const burstCount = Math.floor(rnd(5, 12));
        for (let i = 0; i < burstCount; i++) {
          const t = setTimeout(() => {
            const x = rnd(40, window.innerWidth - 40);
            const y = window.innerHeight - 10;
            createSpark(x, y);
          }, i * rnd(80, 160));
          nervousIntervals.push(t);
        }
        const tNext = setTimeout(sparkLoop, rnd(300, 900));
        nervousIntervals.push(tNext);
      }

      // ambient sparks
      function ambientSparks() {
        if (!window.__nervousRunning) return;
        if (document.querySelectorAll('.spark').length < MAX_SPARKS && Math.random() < 0.85) {
          createSpark(rnd(40, window.innerWidth - 40), rnd(60, window.innerHeight - 120));
        }
        const t = setTimeout(ambientSparks, rnd(200, 700));
        nervousIntervals.push(t);
      }

      // start loops
      nervousIntervals.push(setTimeout(sparkLoop, 100));
      nervousIntervals.push(setTimeout(ambientSparks, 300));

      // pointerdown handler
      nervousPointerHandler = (e) => {
        if (!window.__nervousRunning) return;
        const burstAmount = Math.floor(rnd(10, 18));
        for (let i = 0; i < burstAmount; i++) {
          const t = setTimeout(() => {
            const s = document.createElement('div');
            s.className = 'spark';
            if (Math.random() < 0.45) s.classList.add('streak');
            const color = pick(SPARK_COLORS);
            s.style.background = color;
            s.style.left = `${e.clientX + rnd(-20, 20)}px`;
            s.style.top = `${e.clientY + rnd(-20, 20)}px`;
            const dur = Math.floor(rnd(1300, 2200));
            s.style.animation = `sparkFall ${dur}ms ease-out forwards`;
            scene.appendChild(s);
            setTimeout(() => { if (s && s.parentNode) s.parentNode.removeChild(s); }, dur + 120);
          }, i * rnd(20, 70));
          nervousIntervals.push(t);
        }
        scene.classList.add('shake');
        setTimeout(() => scene.classList.remove('shake'), 300);
      };

      document.addEventListener('pointerdown', nervousPointerHandler);
    }

    function stopTheme() {
      window.__nervousRunning = false;

      // clear all scheduled timeouts
      nervousIntervals.forEach(id => clearTimeout(id));
      nervousIntervals = [];

      // remove pointer handler
      if (nervousPointerHandler) {
        document.removeEventListener('pointerdown', nervousPointerHandler);
        nervousPointerHandler = null;
      }

      // remove all sparks
      document.querySelectorAll('.spark').forEach(s => s.remove());

      // ensure scene is not pointerable
      scene.style.pointerEvents = 'none';
    }

    // Optional: auto-start when page loads (comment out if not needed)
    // startTheme();
  </script>
</body>

</html>